<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" >
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:webgl="http://www.xml3d.org/2009/xml3d/webgl" xmlns:physics="http://www.xml3d.org/2009/physics">
    <head>
        <link rel="stylesheet" type="text/css" media="screen" href="media/style.css" />
        <script type="text/javascript" src="lib/jquery-1.4.4.min.js"></script>
		<script type="text/javascript" src="lib/jquery-ui-1.8.9.custom.min.js"></script>
        <script type="text/javascript" src="lib/jquery.cookie.js"></script>
        <script type="text/javascript" src="lib/xml3dwiki.js"></script>
        <script type="text/javascript" src="lib/util.js"></script>
        <script type="text/javascript" src="lib/toolbar.js"></script>
        <script type="text/javascript" src="lib/em.js"></script>
        <script type="text/javascript" src="lib/comm.js"></script>
        <script type="text/javascript">
        $(document).ready(function() {
            X3D.log.init($('#output').get(0));
            X3D.em.init($('#status div'));
            X3D.tb.init();
            X3D.ws.init();
            X3D.main.init();

            // ugly workaround
            $('#MyXml3d').css('height', window.innerHeight-33);

            $('#collexp').click(function(evt) {
                $('#debug').slideToggle('fast', function() {
                    $.cookie("debug", $('#debug').is(':visible'));

                    $('#collexp').attr('src', $('#debug').is(':visible')
                        ? 'media/coll.png' : 'media/exp.png');
                })
            });

            // activate last known debug setting
            if ($.cookie('debug') == true) $('#collexp').click();

            $('#status div').click(function(evt) {
                X3D.ws.toggle();
            });
        });
        </script>
    </head>
    <body>
        <div id="main">
            <div class="toolbar">
                <ul id="tools">
                    <li id="logo">XML3D</li>
                    <li><button type="button" onclick="tb.addCube();"><img src="" alt="foo"/></button></li>
                    <li><button type="button" onclick="X3D.main.createBox('box3');"><img src="" alt="bar"/></button></li>
                    <li><button type="button"><img src="" alt="foo"/></button></li>
                    <li><button type="button"><img src="" alt="foo"/></button></li>
                    <li><button type="button"><img src="" alt="foo"/></button></li>
                    <li><button type="button"><img src="" alt="foo"/></button></li>
                    <li><button type="button"><img src="" alt="foo"/></button></li>
                    <li><button type="button"><img src="" alt="foo"/></button></li>
                    <li id="status"><div>&nbsp;</div></li>
                </ul>
            </div>
            <xml3d xmlns="http://www.xml3d.org/2009/xml3d" id="MyXml3d" activeView="#defaultView" physics:gravity="0 -10 0">
                <defs id="3dDefs">
                    <transform id="ex6_1_boxXfm1" translation="-1.5 0 0" />
                    <transform id="ex6_1_boxXfm2" translation="1.5 0 0" />
                    <transform id="posTransformbox3" translation="3 0 0" />
                    <shader id="redShader" script="urn:xml3d:shader:phong">
                        <float3 name="diffuseColor">1.0 0.0 0.0</float3>
                        <float name="ambientIntensity">1.0</float>
                    </shader>
                    <shader id="blueShader" script="urn:xml3d:shader:phong">
                        <float3 name="diffuseColor">0.0 0.0 1.0</float3>
                        <float name="ambientIntensity">1.0</float>
                    </shader>
                    <transform id="ex3_1_boxXfm" scale="1.5 0.5 1.0"  rotation="0 0 1 0.3" translation="-0.5 0 0"/>
                    <lightshader id="ex5_1_lightShader" script="urn:xml3d:lightshader:point">
                        <float3 name="intensity">0.9 0.6 0.3</float3>
                        <float3 name="attenuation">0 0 1</float3>
                        <bool name="castShadow">true</bool>
                    </lightshader>
                    <transform id="ex5_1_lightXfm" translation="0 1.5 -4.5"/>
                    <data id="squareData" >
                        <!--><int name="index">0 1 2  1 2 3</int>
                        <float3 name="position">-1 -1 -5 1 -1 -5 -1 1 -5 1 1 -5</float3>
                        <float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2> -->
						<int name="index">0 1 2 2 3 0 4 7 5 5 7 6 8 9 10 10 11 8 12 14 13 14 12 15 16 17 18 18 19 16 20 22 21 22 20 23</int> 
		            <float3 name="position">-1.0 -1.0 -1.0 -1.0 1.0 -1.0 1.0 1.0 -1.0 1.0 -1.0 -1.0 -1.0 -1.0 1.0 -1.0 1.0 1.0 1.0 1.0 1.0 1.0 -1.0 1.0 -1.0 -1.0 -1.0 -1.0 -1.0 1.0 -1.0 1.0 1.0 -1.0 1.0 -1.0 1.0 -1.0 -1.0 1.0 -1.0 1.0 1.0 1.0 1.0 1.0 1.0 -1.0 -1.0 1.0 -1.0 -1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 -1.0 -1.0 -1.0 -1.0 -1.0 -1.0 1.0 1.0 -1.0 1.0 1.0 -1.0 -1.0</float3> 
		            <float3 name="normal">0.0 0.0 -1.0 0.0 0.0 -1.0 0.0 0.0 -1.0 0.0 0.0 -1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 -1.0 0.0 0.0 -1.0 0.0 0.0 -1.0 0.0 0.0 -1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 -1.0 0.0 0.0 -1.0 0.0 0.0 -1.0 0.0 0.0 -1.0 0.0</float3> 
		            <float2 name="texcoord">1.0 0.0 1.0 1.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 1.0 0.0 1.0 1.0 0.0 1.0 1.0 0.0 0.0 0.0 0.0 1.0 1.0 1.0 0.0 1.0 0.0 0.0 1.0 0.0 1.0 1.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0 0.0</float2>
                    </data>
                </defs>
                <view id="defaultView" position="0 0 20" orientation="0 0 0 0"/>   
                <group id="box1" transform="#ex6_1_boxXfm1" shader="#blueShader">
                    <mesh type="triangles" src="#squareData"></mesh>
                </group>

                <group id="box2" transform="#ex6_1_boxXfm2" shader="#blueShader">
                    <mesh type="triangles" src="#squareData"></mesh>
                </group>
            </xml3d>
            <br />
            <div id="xml3d_scripts"> 
                <script type="text/javascript" src="lib/xml3d.js"></script>
            </div> 
        </div>
        <div id="expand">
            <img id="collexp" src="media/exp.png" alt="Collapse / Expand debugging information" />
        </div>
        <div id="debug">
            <h3 class="toolbar" id="debugheader">Debugging Output</h3>
            <textarea id="output" readonly="readonly"></textarea>
        </div>
    </body>
</html>
